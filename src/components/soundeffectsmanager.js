define(["apphost","pluginManager","userSettings","connectionManager","events","dom"],function(appHost,pluginManager,userSettings,connectionManager,events,dom){"use strict";function reload(){var soundeffectPlugin=getCurrentPlugin();soundeffectPlugin?setEffects(soundeffectPlugin):effects={}}function getDefaultId(){return"defaultsoundeffects"}function getCurrentPlugin(){var soundeffectOption;try{soundeffectOption=userSettings.soundEffects()}catch(err){}var defaultOption=getDefaultId();if(soundeffectOption||(soundeffectOption=defaultOption),"none"===soundeffectOption)return null;var soundeffectPlugin=pluginManager.ofType("soundeffects").filter(function(i){return i.id===soundeffectOption})[0];return soundeffectPlugin||(soundeffectPlugin=pluginManager.ofType("soundeffects").filter(function(i){return i.id===defaultOption})[0]),soundeffectPlugin}function setEffects(soundeffectPlugin){var effectDictionary=soundeffectPlugin.getEffects(),temp={};for(var i in effectDictionary)temp[i]=pluginManager.mapPath(soundeffectPlugin,effectDictionary[i]);effects=temp}function onKeyDown(evt){switch(evt.keyCode){case 37:case 38:case 39:case 40:evt.altKey||play("navigation");break;case 13:play("select")}}function play(type){var effect=effects[type];if(effect)return soundEffectsPlayer?void soundEffectsPlayer.play({path:effect}):void require(["soundeffects"],function(soundeffects){soundEffectsPlayer=soundeffects,soundEffectsPlayer.play({path:effect})})}var soundEffectsPlayer,effects={};return appHost.supports("soundeffects")&&dom.addEventListener(window,"keydown",onKeyDown,{passive:!0}),reload(),events.on(connectionManager,"localusersignedin",reload),events.on(userSettings,"change",function(e,name){"soundeffects"===name&&reload()}),{}});